<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Flappy Bird</title>

    <style>
        body {
            background-color: black;
            margin: 10px;
            padding: 0px;
        }

        canvas {
            outline: none;
            display: block;
            margin: auto;
        }
    </style>
    
    <script src="https://cdn.jsdelivr.net/gh/librepaint/drawlite@main/javascript/drawlite.js"></script>
</head>
<body>

    <canvas id="canvas"></canvas>
    
    <script src="./font-bitmaps.js"></script>

    <script type>
/**
    Flappy Bird Made By VExcess
    
    The original took me about 25 hours of work over a few days.
    I've spent 4.5 hours porting it from PJS to Drawlite and reworking the graphics to work on non 600x500 canvases.
    
    Post your highscore in the tips and thanks to be added to the leaderboard!
    
    This is my own version. No code was taken from either Kazza++'s or Kevin23's flappy bird.
    
    Thanks to KWC for the prevent scroll default code.
**/

var canvas = document.getElementById("canvas");
var dl = Drawlite(canvas);
var { PI, TWO_PI, EPSILON, CORNER, CORNERS, LEFT, RIGHT, TOP, CENTER, BOTTOM, BASELINE, RADIUS, DEGREES, RADIANS, POINTS, LINES, TRIANGLES, TRIANGLE_STRIP, TRIANGLE_FAN, QUADS, QUAD_STRIP, CLOSE, ROUND, PROJECT, SQUARE, BEVEL, MITER, RGB, HSB, NATIVE, canvas, Color, PerlinNoise, PRNG, vec3, ctx, size, angleMode, noLoop, loop, frameRate, min, max, floor, round, ceil, abs, constrain, sq, sqrt, pow, sin, cos, tan, asin, acos, atan, atan2, log, random, dist, map, lerp, radians, degrees, color, lerpColor, fill, stroke, strokeWeight, strokeCap, strokeJoin, noStroke, noFill, beginShape, vertex, curveVertex, bezierVertex, bezierPoint, bezierTangent, splineTightness, splineVertex, splinePoint, splineTangent, lerpSpline, endShape, spline, snip, getColor, imageMode, image, loadImage, font, textSize, textAlign, textWidth, textAscent, textDescent, textLeading, text, background, point, line, rectMode, rect, triangle, quad, arc, circle, ellipseMode, ellipse, bezier, get, pushMatrix, popMatrix, resetMatrix, scale, translate, rotate, loadPixels, updatePixels, colorMode, enableContextMenu, millis, second, minute, hour, day, month, year, smooth, nosmooth, createGraphics, getProperties } = dl;

function getSound(s) {
    let url = 'https://cdn.kastatic.org/third_party/javascript-khansrc/live-editor/sounds/' + s + '.mp3';
    return new Audio(url);
}
function playSound(s) {
    s.play();
}

var originalWidth = 600;
var originalHeight = 500;
var globalScale = 1;

size(originalWidth, originalHeight);

function adjustCanvasSize() {
    var targetRatio = originalWidth/originalHeight;
    var maxWidth = window.innerWidth-20;
    var maxHeight = window.innerHeight-20;

    if (maxWidth / maxHeight > targetRatio) {
        // height is the limiting factor
        size(maxHeight * targetRatio, maxHeight);
        globalScale = maxHeight / originalHeight;
    } else {
        // width is the limiting factor
        size(maxWidth, maxWidth / targetRatio);
        globalScale = maxWidth / originalWidth;
    }
}
adjustCanvasSize();
// window.addEventListener("resize", adjustCanvasSize);

function mouseX() {
    return get.mouseX / globalScale;
}

function mouseY() {
    return get.mouseY / globalScale;
}

// ----------------------------------------------------------------------------

var scores = [
    ["VEXCESS", 59],
    ["Pokemaster", 11],
    ["Blue Dragon", 33],
    ["LEADER STUDIOS", 3],
    ["The Crazy Cat", 3],
    ["Gyunam Kim", 53],
    ["MBONKA", 8],
    ["SpaceRanger", 71],
    ["freshgameryt1", 0],
    ["Akul NG", 43],
    ["EllyLaM12", 11],
    ["solf12", 2],
    ["Hello!", 2],
    ["Jeremy = 299 792 458 m / s", 3],
    ["Annabanana07", 3],
    ["Adriel Gonsalves", 27],
    ["LeafersProductions", 5],
    ["bradteng08", 10],
    ["Steffan", 2],
    ["Nuri Muhammad-Coney", 3],
    ["The No-Sock Guy", 24],
    ["jelly school", 75],
    ["liam.allen2", 5],
    ["The Head Collector", 38],
    ["Cloudy", 17],
    ["Woolstone", 54],
    ["Paul", 3],
    ["Cord Goodspeed", 21],
    ["Shelby lynn", 7],
    ["CHAINLINK", 61],
    ["Chocolate Programming", 1],
    ["jozelynne_rodasguillen", 7],
    ["LogisticLand369", 39],
    ["Sushant Dhamija", 0],
    ["FINISHED CODE", 10],
    ["TheMoneyLord(TML)", 81],
    ["(EMPTY)", 0],
    ["YOU", 0],
];

var sortScores = function(){
    scores.sort(function(a, b) {
        return b[1] - a[1];
    }); 
};
sortScores();

var shouldDrawLogo = true;

pushMatrix();
    scale(globalScale);
    background(0, 0, 0, 0);
    noStroke();
    for (var x = 0; x < originalWidth;  x += 10) {
        for (var y = 0; y < originalHeight;  y += 10) {
            fill(0, 0, random(0, 150));
            rect(x, y, 10+1, 10+1);
        }
    }
popMatrix();
noFill();
strokeWeight(5);
var circleDiam = dist(0, 0, get.width/2, get.height/2) * 2;
for (var s = circleDiam; s > 0; s -= 5) {
    stroke(0, 0, 0, map(s, circleDiam, circleDiam/2, 225, 0));
    ellipse(get.width/2, get.height/2, s, s);
    if (s/4 < 10) {
        break;
    }
}
var logoBackground = snip(0, 0, get.width, get.height);

var logoIMG;
function createLogo(logoSz, noRound) {
    var scl = logoSz / 400;
    var width = get.width;
    var height = get.height;
    
    noStroke();
    for (var i = 0; i < logoSz; i++) {
        var j = map(i, 0, logoSz, 0, 400);
        fill(0, j / 20, j / 5);
        rect(0, i, logoSz, 1);
    }
    
    pushMatrix();
        scale(scl);
        
        strokeWeight(40);
        stroke(34, 177, 76);
        strokeCap("butt");
        
        line(0, 0, 200, 400);
        line(400, 0, 200, 400);
        
        line(100, -20, 300, 200);
        line(300, -20, 100, 200);
    popMatrix();
    
    noStroke();
    for (var i = 0; i < logoSz * 1/4; i++) {
        var j = map(i, 0, logoSz, 0, 400);
        fill(0, 0, 0, 100 - j);
        rect(0, i, width, 1);
    }
    
    function triangleCap (x, y, r, s) {
        pushMatrix();
            translate(x, y);
            rotate(r);
            translate(-s / 2, -s / 2);
            
            triangle(-14, -14, s, 0, 0, s);
        popMatrix();
    }
    
    var clr;
    function S (xOff, yOff) {
        pushMatrix();
            translate(xOff * scl, yOff * scl);
            scale(scl);
            
            strokeCap(ROUND);
            strokeWeight(20);
            stroke(clr);
            line(199, 119, 123, 203);
            line(123, 203, 275, 203);
            line(275, 203, 199, 354);
            
            noStroke();
            fill(clr);
            triangleCap(199, 119, 68, 15);
            triangleCap(123, 203, 296, 15);
            triangleCap(275, 203, 296 + 180, 15);
            triangleCap(199, 354, 233, 15);
        popMatrix();
    }
    
    clr = color(0, 200 / 3, 255 / 3);
    S(5, 5);
    
    clr = color(0, 200, 255);
    S();
    
    var logo = snip(0, 0, logoSz, logoSz);
    
    background(0, 0, 0, 0);
    
    noStroke();
    fill(255, 255, 255);
    rect(0, 0, logoSz, logoSz, noRound ? 0 : 100 * scl);
    
    var logoShape = snip(0, 0, logoSz, logoSz);
    
    if (logoShape) {
        logo.mask(logoShape);
    }
    
    return logo;
}

logoIMG = createLogo(300 * globalScale);

var timer = 0;
var iconX = 400;
var textX = -400;
function drawLogo() {
    image(logoBackground, 0, 0);

    imageMode(CENTER, CENTER);
    image(logoIMG, get.width/2 + iconX*globalScale, get.height*0.4);
    imageMode(LEFT, TOP);

    pushMatrix();
        scale(globalScale);

        scale(1.5, 1.2505);

        font("monospace", 25);
        textAlign(CENTER, CENTER);
        fill(255, 255, 255);
        text("VEXCESS PROGRAMMING", 200+textX, originalHeight*0.65);
    popMatrix();

    timer += 1.3;
    if (iconX > 0) {
        iconX -= dist(iconX, 200, 0, 200)/20;
    }
    if (textX < 0) {
        textX += dist(textX, 200, 0, 200)/20;
    }
    
    if (timer > 150) {
        iconX -= dist(iconX, 200, 0, 200)/20;
        textX += dist(textX, 200, 0, 200)/20;
        textX += 3;
        iconX -= 3;
    }
    
    if (timer > 200) {
        noStroke();
        fill(0, 0, 0, (timer-200)*5);
        rect(-1, -1, get.width, get.height);
    }
    
    if (timer > 250) {
        shouldDrawLogo = false;
    }
}

var loaded = false;
var loadPixelFontCounter = 0;
var letters = [];
function loadPixelText() {
    if (loadPixelFontCounter < bitLetters.length) {
        noStroke();
        background(0, 0, 0, 0);
        
        fill(145, 115, 40);
        for (var x = 0; x < bitLetters[loadPixelFontCounter][0].length; x++) {
            for (var y = 0; y < bitLetters[loadPixelFontCounter].length; y++) {
                if (bitLetters[loadPixelFontCounter][y][x] === 1) {
                    rect(x*(57), y*(57), 57+0, 57+0);
                }
            }
        }
            
        letters.push(snip(0, 0, 285, 400));
        
        loadPixelFontCounter++;
        
        background(255, 255, 255);
        fill(0, 0, 0);
        textAlign(CENTER, CENTER);
        font("sans-serif", 20);
        text("LOADING: " + round((loadPixelFontCounter/bitLetters.length)*100) + "%", 300, 150);
        
        fill(0, 0, 0);
        rect(50, 200, 500, 30);
        fill(255, 255, 255);
        rect(55, 205, 490, 20);
        fill(0, 0, 0);
        rect(60, 210, (loadPixelFontCounter/bitLetters.length)*480, 10);
        
    } else {
        loaded = true;
    }
}

function loadBack() {
    var clrs = [
        color(234, 253, 219),
        color(225, 240, 207),
        color(113, 198, 208),
        color(130, 227, 137),
        color(110, 202, 138),
        color(161, 218, 225),
        color(183, 223, 193),
    ];

    var pixArt = [
        "222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222000000222222222222222222222222222222222222222222",
        "222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222200000000002222222222222222222222222222222222222222",
        "222222000000222222222222222222222222222222222222222222222222222222222222222000000222222222220000000000000022222222222222222222222222222222222222",
        "222200000000002222222222222222222222222222222222222222222222222222222222200000000000222222200000000000000002222222222222222222222222222222222222",
        "220000000000000022222222222222222222222222200000022222222222222222222220000000000000002222000000000000000002222200000022222222222222222222222222",
        "200000000000000002222222222222222222222220000000000222222222220000002200000000000000000020000000000000000000220000000000222222222220000002222220",
        "000000000000000000222222222222222222222000000000000002222222000000000000000000000000000000000000000000000000000000000000002222222000000000022200",
        "000000000000000000022222222222222222220000000000000000222200000000000000000000000000000000000000000000000000000000000000000222200000000000000000",
        "000000000000000000022222222222222222200000000000000000022000000000000000000000000000000000000000000000000000000000000000000022000000000000000000",
        "000000000000000000002222200000022222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "000000000000000000002220000000000222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "000000000000000000000000000666555550000000000000000000000000066655555000000000000000000000000000666555550000000000000000000000000066655555000000",
        "000000000000000000000000000611511150000000000000000000000000061151115000000000000000000000000000611511150000000000000000000000000061151115000000",
        "000000000000000111110000006555516150000000000000011111000000555551615000000000000000111110000006555516150000000000000011111000000555551615000000",
        "000000000000011111110000005111111150000000000001111111000000511111115000000000000011111110000005111111150000000000001111111000000511111115000000",
        "555000000000111111555555505161616155550000000011111155555550516161615555000000000111111555555505161616155550000000011111155555550516161615555000",
        "615000000001111111511116505161616156150000000111111151111650516161615615000000001111111511116505161616156150000000111111151111650516161615615000",
        "555555500001111111516116505111111155555555000111111151611650511111115555555500001111111516116505111111155555555000111111151611650511111115555555",
        "611111511101111555555555505161616156111115110111155555555550516161615611111511101111655555555505161616156111115110111155555555550516161615611111",
        "611111511101111511111166505161616156111115110111151111116650516161615611111511101111511111166515161616156111115110111151111116650516161615611111",
        "616161511101111561616166515111111156161615110111156161616651511111115616161511101111561616166515111111156161615110111156161616651511111115616161",
        "616161511101111561616166565111111156161615110111156161616656511111115616161511101111561616166565111111156161615110111156161616656511111115616161",
        "611111511101111511111555555161616156111115110111151111155555516161615611111511101111511111555555161616156111115110111151111155555516161615611111",
        "616161511101111561616511165161616156161615110111156161651116516161615616161511101111561616511165161616156161615110111156161651116516161615616161",
        "616161511101111561616516165111111156161615111111156161651616511111115616161511101111561616516165111111156161615111111156161651616511111115616161",
        "611111511111111511111516165161616156111115111111151111151616516161615611111511111111511111516165161616156111115111111151111151616516161615611111",
        "515151511444411551515511444451515144441615111111144441651444416161615616161511444411561616511444461616144441615111111144441551444416161615611444",
        "515151544333344551515544333344114433334415111114433334444333344111115616161544333344561616544333344114433334415111114433334444333344111115644333",
        "511114433333333441144443333333443333333344614444333333344333333441544611114433333333441144443333333443333333344514444333333344333333441644443333",
        "444143333333333444433334433333334333444433443333443333333433334444433444143333333333334433334433333334333444433443333443333333433334444433334433",
        "333443333333333443333333344333334344333344333333334433333433443333333333443333333333443333333344333334344333344333333334433333433443443333333344",
        "333334433444434333333333333433344443333433333333333343333444433333333333334433444434333333333333433344443333433333333333343333444434333333333333",
        "333333344333344333333333333434433334433433333333333343344333344333333333333344333344333333333333434433334433433333333333343344333344333333333333",
        "333334433333333443333333333443333333344333333333333334433333333443333333334433333333443333333333443333333344333333333333334433333333443333333333",
        "333343333333333334333333334333333333334333333333333334333333333334333333343333333333334333333334333333333334333333333333334333333333334333333334",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
        "333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
    ];

    pushMatrix();
        scale(globalScale);

        noStroke();
        for (var y = 0; y < pixArt.length; y++) {
            var row = [];
            for (var x = 0; x < pixArt[y].length; x++) {
                fill(clrs[pixArt[y][x]]);
                rect(x*4.17, 0 + y*4.17, 5, 5);
            }
        }

        fill(85, 78, 64);
        rect(0, 195, 600, 5+1);

        fill(151, 176, 118);
        rect(0, 215, 600, 5+1);

        fill(191, 159, 81);
        rect(0, 220, 600, 5+1);

        for (var i = 0; i < 5; i++) {
            var d = pow(i, 1.25);
            fill(203-d*6, 196-d*4, 133-d*2);
            rect(0, 225+i*5, 600, 5+1);
        }
    popMatrix();
        
    return snip(0, 0, 600*globalScale, 250*globalScale);
}
var backIMG = loadBack();

function loadGround() {
    pushMatrix();
        scale(globalScale);

        noStroke();
        fill(85, 78, 64);
        rect(0, 195, 600, 5+1);

        fill(205, 224, 123);
        rect(0, 0, 600, 5+1);
        
        for (var i = 0; i < 3; i++) {
            fill(149, 218, 83);
            rect(0, 5 + i*5, 600, 5+1);
            for (var j = 0; j < 18; j++) {
                var shadowX = j*17.7*2 - i*4 + (4 + 2*4);
                
                fill(0, 40);
                rect(shadowX, 5 + i*5, 15, 5+1);
                
                fill(0, 17);
                rect(shadowX - 4, 5 + i*5, 4, 5+1);
                rect(shadowX + 15, 5 + i*5, 4, 5+1);
            }
        }
        
        fill(126, 184, 69);
        rect(0, 5*4, 600, 1+1);
    popMatrix();
    return snip(0, 0, 600*globalScale, 21*globalScale);
}
var groundIMG = loadGround();

function loadBird() {
    var pixelArtArray = [
        [0,0,0,0,0,0,13,13,13,13,13,13,0,0,0,0,0,0,0],
        [0,0,0,0,13,13,4,4,4,13,1,1,13,0,0,0,0,0,0],
        [0,0,0,13,4,4,3,3,13,1,1,1,1,13,0,0,0,0,0],
        [0,0,13,4,3,3,3,3,13,5,1,1,13,1,13,0,0,0,0],
        [0,13,3,3,3,3,3,3,13,5,1,1,13,1,13,0,0,0,0],
        [0,13,3,3,3,3,3,3,3,13,5,1,1,1,13,0,0,0,0],
        [0,13,13,13,13,13,3,3,3,3,13,13,13,13,13,13,0,0,0],
        [13,4,1,1,1,4,13,3,3,13,2,2,2,2,2,2,13,0,0],
        [13,1,1,1,1,13,8,8,13,2,13,13,13,13,13,13,0,0,0],
        [13,1,1,4,13,8,8,8,8,13,2,2,2,2,2,13,0,0,0],
        [0,13,13,13,13,8,8,8,8,8,13,13,13,13,13,0,0,0,0],
        [0,0,0,0,0,13,13,13,13,13,0,0,0,0,0,0,0,0,0],
    ];
    var colors = [
        color(0, 0, 0, 1),
        color(255, 255, 255),
        color(255, 51, 36),
        color(255, 170, 0),
        color(255, 217, 140),
        color(197, 232, 177),
        color(255, 255, 255),
        color(255, 255, 255),
        color(235, 121, 0),
        color(255, 255, 255),
        color(255, 255, 255),
        color(255, 255, 255),
        color(255, 255, 255),
        color(87, 41, 63),
    ];
    pushMatrix();
        scale(globalScale);

        background(0, 0, 0, 0);
        noStroke();
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(i*(3), j*(3), 3+1, 3+1);
            }
        }
    popMatrix();
    return snip(0, 0, 51*globalScale, 36*globalScale);
}
var bird = loadBird();

//other functions
function pipe(x, h, flipped) {
    if (!flipped) {
        pushMatrix();
            scale(globalScale);

            translate(x-168, 280-h);
            noStroke();
            //top
            fill(0, 0, 0);
            rect(168, 133, 3, 29);
            rect(227, 133, 3, 29);
            rect(168, 132, 62, 5);
            rect(168, 160, 62, 2);
            
            fill(0, 161, 6);
            rect(171, 135, 2, 22);
            rect(183, 135, 29, 22);
            rect(217, 135, 4, 22);
            
            fill(231, 255, 117);
            rect(173, 135, 2, 22);
            rect(180, 135, 3, 22);
            rect(174, 135, 53, 3);
            
            fill(121, 217, 56);
            rect(175, 138, 5, 19);
            
            fill(26, 130, 0);
            rect(212, 135, 5, 22);
            rect(220, 135, 7, 22);
            rect(171, 157, 56, 3);
            rect(173, 162, 52, 3);
            
            //bottom
            fill(0, 0, 0);
            rect(170, 162, 3, h+3);
            rect(225, 162, 3, h+3);
            
            fill(0, 161, 6);
            rect(173, 165, 2, h);
            rect(190, 165, 20, h);
            rect(215, 165, 2, h);
            
            fill(231, 255, 117);
            rect(175, 165, 5, h);
            rect(187, 165, 3, h);
            
            fill(121, 217, 56);
            rect(180, 165, 7, h);
            
            fill(26, 130, 0);
            rect(210, 165, 5, h);
            rect(217, 165, 8, h);
        popMatrix();
    }
    if (flipped) {
        pushMatrix();
            scale(globalScale);
            
            translate(x-168, h+165);
            scale(1, -1);
            noStroke();
            //top
            fill(0, 0, 0);
            rect(168, 133, 3, 29);
            rect(227, 133, 3, 29);
            rect(168, 132, 62, 5);
            rect(168, 160, 62, 2);
            
            fill(0, 161, 6);
            rect(171, 135, 2, 22);
            rect(183, 135, 29, 22);
            rect(217, 135, 4, 22);
            
            fill(231, 255, 117);
            rect(173, 135, 2, 22);
            rect(180, 135, 3, 22);
            rect(174, 135, 53, 3);
            
            fill(121, 217, 56);
            rect(175, 138, 5, 19);
            
            fill(26, 130, 0);
            rect(212, 135, 5, 22);
            rect(220, 135, 7, 22);
            rect(171, 157, 56, 3);
            rect(173, 162, 52, 3);
            
            //bottom
            fill(0, 0, 0);
            rect(170, 162, 3, h+3);
            rect(225, 162, 3, h+3);
            
            fill(0, 161, 6);
            rect(173, 165, 2, h);
            rect(190, 165, 20, h);
            rect(215, 165, 2, h);
            
            fill(231, 255, 117);
            rect(175, 165, 5, h);
            rect(187, 165, 3, h);
            
            fill(121, 217, 56);
            rect(180, 165, 7, h);
            
            fill(26, 130, 0);
            rect(210, 165, 5, h);
            rect(217, 165, 8, h);
        popMatrix();
    }
}

var pipes = [];
for (var i = 0; i < 5; i ++) {
    pipes.push([500+i*300, random(75, 350)]);
}

function borderText(words, x, y, size) {
    textSize(size);
    
    fill(30, 15, 0);
    text(words, x-2, y);
    text(words, x+2, y);
    text(words, x, y-2);
    text(words, x, y+2);
    text(words, x-2, y-2);
    text(words, x+2, y+2);
    text(words, x-2, y+2);
    text(words, x+2, y-2);
    
    fill(255, 255, 255);
    text(words, x, y);
}

function pixelText(words, x, y, size) {
    pushMatrix();
        translate(x, y);
        scale(size/200);
        
        var Schar = stringLetters;
        var newWords = [];
        
        for (var i = 0; i < words.length; i++) {
            var char = words.charAt(i);
            
            for (var c = 0; c < Schar.length; c++) {
                if (char === Schar[c]) {
                    newWords.push(c);
                    break ;
                }
            }
        }
        
        for (var i = 0; i < newWords.length; i++) {
            image(letters[newWords[i]], i*325, 0);
        }
        
    popMatrix();
}

//variables
var scene = 1;
var playerY = 200;
var playerYVel = 0;
var dying = false;
var speed = 2;
var highscore = 0;
var score = 0;
var sound = true;
var playing = false;
var gameResultsY = 400;
var gameOverBounce = [0, -3];
var resultsScore = 0;
var scoresScroll = 0;

// var WindowNoScroll = 0;
// var loadWindowNoScroll = function(){
//     if(WindowNoScroll === 0){
//         var window = (function(what) { return this[what]; })("window");
//         var canvas = window.Processing.instances[0].externals.canvas;
        
//         canvas.onwheel = function(event){
//             event.preventDefault();
//         };
        
//         WindowNoScroll = 1;
//     }
// };

//draws
function drawBack() {
    background(113, 198, 208);
    image(backIMG, 0, 250*globalScale);
}

var groundX = 0;
function drawGround() {
    image(groundIMG, groundX*globalScale, 450*globalScale);
    image(groundIMG, groundX*globalScale + get.width - 1, 450*globalScale);
    
    groundX -= speed*2;
    if (groundX <= -600) {
        groundX = 0;
    }
}

function drawPlayer() {
    pushMatrix();
        translate(100*globalScale, playerY*globalScale);
        rotate(playerYVel*5);
        image(bird, -(51*globalScale*0.2), -(36*globalScale*0.5));
    popMatrix();
}

function drawScore() {
    pushMatrix();
        scale(globalScale);

        textAlign(CENTER, CENTER);
        font("impact", 50);
        fill(0, 0, 0);
        text(floor(score), 295, 50);
        text(floor(score), 305, 50);
        text(floor(score), 300, 45);
        text(floor(score), 300, 55);
        text(floor(score), 305, 45);
        text(floor(score), 305, 55);
        text(floor(score), 295, 45);
        text(floor(score), 295, 55);
        
        fill(255, 255, 255);
        text(floor(score), 300, 50);
    popMatrix();
}

function drawGameOverText() {
    pushMatrix();
        scale(globalScale);

        translate(89, gameOverBounce[0]);
        scale(0.7);
        
        gameOverBounce[0] += gameOverBounce[1];
        gameOverBounce[1] += 0.1;
        
        if (gameOverBounce[0] > 0) {
            gameOverBounce[0] = 0;
        }
        
        noStroke();
        //GAME
        fill(255, 191, 0);
        rect(17, 77, 120, 105);
        rect(117, 83, 120, 97);
        rect(238, 80, 60, 100);
        
        fill(84, 29, 0);
        rect(17, 76, 5, 105);
        rect(296, 77, 5, 104);
        rect(234, 77, 5, 104);
        rect(136, 75, 5, 106);
        rect(18, 176, 281, 5);
        rect(17, 75, 124, 5);
        rect(141, 82, 97, 5);
        rect(234, 77, 67, 5);
        rect(47, 107, 5, 44);
        rect(73, 107, 5, 70);
        rect(80, 79, 5, 32);
        rect(47, 107, 63, 5);
        rect(102, 145, 7, 7);
        rect(166, 112, 5, 68);
        rect(204, 112, 5, 68);
        rect(265, 108, 6, 6);
        rect(265, 148, 32, 6);
        
        fill(255, 242, 178);
        rect(47, 101, 5, 5);
        rect(102, 138, 7, 7);
        rect(265, 101, 6, 6);
        rect(265, 143, 31, 6);
        rect(240, 170, 56, 6);
        rect(209, 170, 25, 6);
        rect(171, 170, 33, 6);
        rect(141, 170, 25, 6);
        rect(79, 170, 57, 6);
        rect(22, 170, 51, 6);
        rect(166, 107, 5, 5);
        rect(204, 107, 5, 5);
        
        //OVER
        fill(255, 191, 0);
        rect(339, 77, 59, 105);
        rect(400, 83, 59, 93);
        rect(463, 77, 59, 105);
        rect(522, 83, 34, 93);
        rect(550, 83, 34, 54);
        
        fill(84, 29, 0);
        rect(335, 76, 5, 105);
        rect(397, 76, 5, 105);
        rect(459, 76, 5, 105);
        rect(521, 76, 5, 105);
        rect(551, 114, 5, 68);
        rect(366, 109, 5, 41);
        rect(428, 86, 5, 65);
        rect(583, 83, 5, 56);
        rect(551, 134, 32, 5);
        rect(524, 83, 64, 5);
        rect(464, 76, 60, 5);
        rect(464, 177, 87, 5);
        rect(408, 177, 45, 5);
        rect(337, 177, 65, 5);
        rect(340, 76, 59, 5);
        rect(402, 171, 6, 6);
        rect(452, 171, 7, 6);
        rect(490, 146, 32, 5);
        rect(401, 82, 62, 5);
        rect(490, 108, 5, 5);
        
        fill(255, 242, 178);
        rect(366, 103, 5, 6);
        rect(490, 102, 5, 6);
        rect(551, 108, 5, 6);
        rect(556, 128, 27, 6);
        rect(526, 171, 25, 6);
        rect(464, 171, 57, 6);
        rect(490, 140, 31, 6);
        rect(340, 171, 57, 6);
        rect(408, 171, 44, 6);
        rect(402, 165, 6, 6);
        rect(453, 165, 6, 6);
    popMatrix();
}

function drawPipes() {
    for (var i = 0; i < pipes.length; i++) {
        if (pipes[i][0] < 605) {
            pipe(pipes[i][0], pipes[i][1]-97, true);
            pipe(pipes[i][0], -pipes[i][1]+348, false);
        }
    }
}

function updatePipes() {
    for (var i = 0; i < pipes.length; i++) {
        pipes[i][0] -= speed;
        
        if (pipes[i][0] < 135 && pipes[i][0] > 100-62 && !dying) {
            if (playerY < pipes[i][1]-50 || playerY > pipes[i][1]+50) {
                background(255, 255, 255);
                dying = true;
                playerYVel = -10;
                if (sound) {
                    playSound(getSound("rpg/hit-whack"));
                }
            } else {
                score += 1/25;
            }
        }
    }
}

function add_removePipes() {
    for (var i = 0; i < pipes.length; i++) {
        if (pipes[i][0] < -50) {
            pipes.splice(i, 1);
            pipes.push([pipes[pipes.length-1][0]+300, random(75, 350)]);
            return;
        }
        
        pipes[i][0] -= speed;
    }
}

function drawFlappyBirdTitle() {
    var colors = [
        color(0, 0),
        color(244, 246, 239),
        color(81, 61, 71),
        color(246, 238, 164),
        color(156, 230, 90),
    ];
    
    var pixelArtArray = [
        [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
        [2,3,3,3,2,3,3,2,3,3,3,2,3,3,3,2,3,3,3,2,3,2,3,2,0],
        [2,3,2,2,2,3,3,2,3,3,3,2,3,2,3,2,3,2,3,2,3,2,3,2,0],
        [2,3,3,3,2,3,2,2,2,3,3,2,3,2,3,2,3,2,3,2,3,2,3,2,0],
        [2,4,2,2,2,4,2,4,4,4,4,2,4,4,4,2,4,4,4,2,4,4,4,2,0],
        [2,4,2,0,2,4,2,4,4,2,4,2,4,4,4,2,4,4,4,2,4,4,4,2,0],
        [2,4,2,0,2,4,2,4,4,4,4,2,4,2,2,2,4,2,2,2,2,2,4,2,0],
        [2,2,2,0,2,2,2,2,2,2,2,2,4,2,0,2,4,2,0,2,4,4,4,2,0],
        [0,0,0,0,0,0,0,0,0,0,0,2,4,2,0,2,4,2,0,2,2,2,2,2,0],
        [0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,2,2,2,0,0,0,0,0,0,0],
    ];
    
    pushMatrix();
        scale(globalScale);

        translate(0, sin(get.frameCount*8)*8);
        
        noStroke();
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(50+i*(8), 92+j*(8), 8.5, 8.5);
            }
        }
        
        var pixelArtArray = [
            [2,2,2,2,2,2,2,2,0,0,0,0,2,2,2],
            [2,3,3,3,2,3,2,3,2,2,2,0,2,3,2],
            [2,3,2,3,2,2,2,3,3,3,2,2,2,3,2],
            [2,3,3,3,2,3,2,3,2,3,2,3,3,3,2],
            [2,4,2,4,2,4,2,4,2,2,2,4,2,4,2],
            [2,4,2,4,2,4,2,4,2,0,2,4,2,4,2],
            [2,4,4,4,2,4,2,4,2,0,2,4,4,4,2],
            [2,2,2,2,2,2,2,2,2,0,2,2,2,2,2],
        ];
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(250+i*(8), 92+j*(8), 8.5, 8.5);
            }
        }
    popMatrix();
    
    pushMatrix();
        translate(305*globalScale, (-75+sin(get.frameCount*8)*8)*globalScale);
        drawPlayer();
    popMatrix();
}

function drawStartButton(colors) {
    pushMatrix();
        if (mouseY() > 349 && mouseY() < 400 && mouseX() > 99 && mouseX() < 250) {
            translate(0, 5);
        }
    
        fill(79, 53, 12);
        rect(100, 350, 150, 50, 3);
        
        fill(248, 235, 227);
        rect(103, 353, 144, 42);
        
        fill(231, 97, 0);
        rect(105, 355, 140, 38);
        
        var pixelArtArray = [
            [0,1,1,1,0,1,1,1,0,0,1,1,0,0,1,1,1,0,0,1,1,1],
            [1,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0],
            [0,1,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0],
            [0,0,0,1,0,0,1,0,0,1,1,1,1,0,1,1,1,0,0,0,1,0],
            [1,1,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0],
        ];
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(119+i*(5), 361+j*(5), 5+1, 5+1);
            }
        }
        
        if (mouseY() > 349 && mouseY() < 400 && mouseX() > 99 && mouseX() < 250) {
            fill(0, 0, 0, 50);
            rect(100, 350, 150, 50, 3);
        }
    popMatrix();
}

function drawScoreButton(colors) {
    pushMatrix();
        if (mouseY() > 349 && mouseY() < 400 && mouseX() > 349 && mouseX() < 500) {
            translate(0, 5);
        }
        
        fill(79, 53, 12);
        rect(350, 350, 150, 50, 3);
        
        fill(248, 235, 227);
        rect(353, 353, 144, 42);
        
        fill(231, 97, 0);
        rect(355, 355, 140, 38);
        
        var pixelArtArray = [
            [0,1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1,0,0,1,1,1],
            [1,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,1,0,0],
            [0,1,1,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,1,1,1],
            [0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0],
            [1,1,1,0,0,0,1,1,0,0,1,1,0,0,1,0,0,1,0,1,1,1],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ];
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(369+i*(5), 361+j*(5), 5+1, 5+1);
            }
        }
        
        if (mouseY() > 349 && mouseY() < 400 && mouseX() > 349 && mouseX() < 500) {
            fill(0, 0, 0, 50);
            rect(350, 350, 150, 50, 3);
        }
    popMatrix();
}

function drawSoundButton(colors) {
    pushMatrix();
        if (mouseX() > 274 && mouseX() < 325 && mouseY() > 424 && mouseY() < 475) {
            translate(0, 5);
        }
    
        fill(79, 53, 12);
        rect(275, 425, 50, 50, 3);
        
        fill(248, 235, 227);
        rect(277, 427, 46, 44, 3);
        
        fill(231, 97, 0);
        rect(279, 429, 42, 40, 3);
        
        var pixelArtArray = [
            [0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [1,1,1,1,1,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [1,1,1,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [1,1,1,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [1,1,1,1,1,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ];
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(282+i*(3), 434+j*(3), 3+1, 3+1);
            }
        }
        
        if (!sound) {
            fill(0, 0, 0);
            for (var i = 0; i < 9; i++) {
                rect(282+i*(4), 463-i*(4), 4, 4);
                rect(282+i*(4), 431+i*(4), 4, 4);
            }
        }
        
        if (mouseX() > 274 && mouseX() < 325 && mouseY() > 424 && mouseY() < 475) {
            fill(0, 0, 0, 50);
            rect(275, 425, 50, 50, 3);
        }
    popMatrix();
}

function drawTap() {
    pushMatrix();
        scale(globalScale);
        
        var pixelArtArray = [
            [0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [0,0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
            [0,0,1,2,2,1,1,1,2,2,1,1,2,2,1,1,1,2,2,2,1],
            [0,1,2,2,2,2,1,2,2,1,2,2,1,2,1,2,2,1,2,2,1],
            [1,2,2,2,2,2,1,2,2,1,2,2,1,2,1,2,2,1,2,2,1],
            [0,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,1,2,2,2,1],
            [0,0,1,2,2,2,1,2,2,1,2,2,1,2,1,2,2,2,2,2,1],
            [0,0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
            [0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
        ];
        
        var colors = [
            color(0, 0, 0, 0),
            color(255),
            color(255, 0, 0),
        ];
        
        noStroke();
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(150+i*(3.5), 300+j*(3.5), 3.5+1, 3.5+1);
            }
        }

        var pixelArtArray = [
            [0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,1,2,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,1,2,2,2,2,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,1,1,1,1,1,2,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,1,2,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,1,2,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,1,2,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,2,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,2,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0],
        ];
        
        var colors = [
            color(0, 0, 0, 0),
            color(255),
            color(92, 92, 92),
        ];
        
        noStroke();
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(52+i*(4), 210+j*(4), 4+1, 4+1);
            }
        }
    popMatrix();
}

function drawGameResults() {
    pushMatrix();
        scale(globalScale);

        translate(0, gameResultsY);
        
        fill(85, 54, 72);
        rect(100, 175, 400, 205);
        
        fill(220, 218, 148);
        rect(105, 180, 390, 190);
        
        fill(224, 180, 98);
        rect(105, 365, 390, 5);
        rect(115, 190, 365, 5);
        rect(115, 190, 5, 155);
        
        fill(234, 230, 165);
        rect(120, 345, 365, 5);
        rect(480, 195, 5, 150);
        
        fill(207, 204, 131);
        rect(120, 195, 360, 150);
        
        fill(238, 236, 168);
        ellipse(200, 285, 80, 80);
        
        fill(194, 190, 120);
        ellipse(200, 283, 80, 78);
        
        pixelText("MEDAL", 160, 210, 10);
        
        pixelText("SCORE", 380, 210, 10);
        
        pixelText("BEST", 395, 280, 9.8);
        
        textSize(22);
        textAlign(RIGHT, CENTER);
        borderText(floor(resultsScore), 450, 251, 28);
        
        borderText(highscore, 450, 320, 28);
        
        if (gameResultsY < 1 && resultsScore < floor(score)) {
            resultsScore += 0.5;
        }
        
        var medalBitMap = [
            [0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0],
            [0,0,0,2,0,0,4,4,2,2,2,2,4,4,0,0,0,0,0,0],
            [0,0,2,1,2,4,2,2,3,3,3,3,2,2,4,4,0,0,0,0],
            [0,2,1,1,1,2,3,3,3,3,3,3,3,3,2,2,4,0,0,0],
            [0,0,2,1,2,3,3,3,3,4,4,4,4,3,3,3,2,4,0,0],
            [0,0,4,2,3,3,3,4,4,4,3,3,3,4,3,3,3,4,0,0],
            [0,4,3,3,3,3,4,3,3,4,3,4,3,3,4,3,3,2,4,0],
            [0,4,3,3,3,4,3,3,3,4,3,4,3,3,4,3,3,3,4,0],
            [4,3,3,3,4,3,3,3,3,4,3,3,3,3,4,3,3,3,3,4],
            [4,3,3,3,4,3,3,3,3,3,4,4,4,4,4,4,3,3,3,4],
            [4,3,3,3,4,4,4,3,3,4,3,3,3,3,3,3,4,3,3,4],
            [4,3,3,4,3,3,4,3,4,3,3,3,4,4,4,4,3,3,3,4],
            [0,4,3,4,4,3,4,3,3,4,4,3,3,3,3,4,3,3,4,0],
            [0,4,3,3,3,4,4,4,3,3,3,4,4,4,4,3,3,3,4,0],
            [0,0,4,3,3,3,3,3,4,4,4,3,3,3,3,3,3,4,0,0],
            [0,0,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,0,0],
            [0,0,0,4,3,3,3,3,3,3,3,3,3,3,3,3,4,0,0,0],
            [0,0,0,0,4,4,3,3,3,3,3,3,3,3,3,4,0,0,0,0],
            [0,0,0,0,0,0,4,4,3,3,3,3,3,4,4,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,4,4,4,4,4,0,0,0,0,0,0,0],
        ];
        
        var medalColors = [];
        if (score > scores[0][1]) {
            medalColors = [
                color(0, 0, 0, 0),
                color(255, 255, 255),
                color(255, 248, 115),
                color(255, 213, 0),
                color(204, 163, 0),
            ];
        } else if (score > scores[1][1]) {
            medalColors = [
                color(0, 0, 0, 0),
                color(255, 255, 255),
                color(222, 222, 222),
                color(199, 199, 199),
                color(163, 163, 163),
            ];
        } else if (score > scores[2][1]) {
            medalColors = [
                color(0, 0, 0, 0),
                color(255, 255, 255),
                color(255, 194, 71),
                color(237, 150, 0),
                color(212, 110, 0),
            ];
        }
        
        if (resultsScore > scores[2][1]) {
            noStroke();
            for (var i = 0; i < medalBitMap[0].length; i++) {
                for (var j = 0; j < medalBitMap.length; j++) {
                    fill(medalColors[medalBitMap[j][i]]);
                    rect(164+i*(3.5), 248+j*(3.5), 3.5, 3.5);
                }
            }
        }
        
    popMatrix();
}

function drawOkButton(colors) {
    pushMatrix();
        scale(globalScale);

        translate(25, 58);
        
        if (mouseY() > 349+58 && mouseY() < 400+58 && mouseX() > 99+25 && mouseX() < 250+25) {
            translate(0, 5);
        }
    
        fill(79, 53, 12);
        rect(100, 350, 150, 50, 3);
        
        fill(248, 235, 227);
        rect(103, 353, 144, 42);
        
        fill(231, 97, 0);
        rect(105, 355, 140, 38);
        
        var pixelArtArray = [
            [0,1,1,0,0,1,0,0,1],
            [1,0,0,1,0,1,0,1,0],
            [1,0,0,1,0,1,1,0,0],
            [1,0,0,1,0,1,0,1,0],
            [0,1,1,0,0,1,0,0,1],
        ];
        
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(149+i*(5), 361+j*(5), 5+1, 5+1);
            }
        }
        
        if (mouseY() > 349+58 && mouseY() < 400+58 && mouseX() > 99+25 && mouseX() < 250+25) {
            fill(0, 0, 0, 50);
            rect(100, 350, 150, 50, 3);
        }
    popMatrix();
}

function drawMenuButton(colors) {
    pushMatrix();
        scale(globalScale);

        translate(-25, 58);
    
        if (mouseY() > 349+58 && mouseY() < 400+58 && mouseX() > 349-25 && mouseX() < 500-25) {
            translate(0, 5);
        }
        
        fill(79, 53, 12);
        rect(350, 350, 150, 50, 3);
        
        fill(248, 235, 227);
        rect(353, 353, 144, 42);
        
        fill(231, 97, 0);
        rect(355, 355, 140, 38);
        
        var pixelArtArray = [
            [1,0,0,0,1,0,1,1,1,0,1,0,0,1,0,1,0,0,1],
            [1,1,0,1,1,0,1,0,0,0,1,1,0,1,0,1,0,0,1],
            [1,0,1,0,1,0,1,1,1,0,1,0,1,1,0,1,0,0,1],
            [1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,1],
            [1,0,0,0,1,0,1,1,1,0,1,0,0,1,0,1,1,1,1],
        ];
        
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(377+i*(5), 361+j*(5), 5+1, 5+1);
            }
        }
        
        if (mouseY() > 349+58 && mouseY() < 400+58 && mouseX() > 349-25 && mouseX() < 500-25) {
            fill(0, 0, 0, 50);
            rect(350, 350, 150, 50, 3);
        }
    popMatrix();
}

//reset
function resetGame() {
    pipes = [];
    for (var i = 0; i < 5; i++) {
        pipes.push([500+i*300, random(75, 350)]);
    }
    
    playerY = 200;
    playerYVel = 0;
    dying = false;
    speed = 2;
    score = 0;
    playing = false;
    gameResultsY = 400;
    gameOverBounce = [0, -3];
    resultsScore = 0;
}

//scenes
var scrolling = false;
var scrollMult = 5.55;
var calculateScore = false;
function scoresScene() {
    if (calculateScore) {
        for (var i = 0; i < scores.length; i++) {
            if (scores[i][0] === "YOU") {
                scores[i][1] = highscore;
            }
        }
        
        sortScores();
        
        calculateScore = false;
    }
    
    drawGround();
    speed = 0;
    
    pushMatrix();
        scale(globalScale);

        fill(85, 54, 72);
        rect(50, 50, 500, 350);
        
        fill(220, 218, 148);
        rect(55, 55, 490, 335);
        
        fill(224, 180, 98);
        rect(55, 385, 490, 5);
        rect(65, 65, 465, 5);
        rect(65, 65, 5, 305);
        
        fill(234, 230, 165);
        rect(70, 370, 465, 5);
        rect(530, 70, 5, 300);
        
        fill(207, 204, 131);
        rect(100, 95, 400, 50);
        rect(100, 180, 400, 170);
        
        pixelText("YOUR BEST SCORE: " + highscore, 110, 110, 9.8);
        
        pixelText("LeaderBoard", 110, 160, 8);
        
        fill(0, 0, 0, 50);
        rect(494, 180, 6, 170);
        
        fill(0, 0, 0, 50);
        rect(494, 180+scoresScroll, 6, 170/3.125);
        
        fill(145, 115, 40);
        textSize(25);
        for (var i = 0; i < scores.length; i++) {
            var y = 185-(scoresScroll*scrollMult)+i*23;
            
            if (y > 180 && y < 180+160) {
                pixelText((i+1)+")", 110, y, 7);
                
                pixelText(scores[i][0], 150, y, 7);
                
                text("-", 300, 5+y);
                
                pixelText(""+scores[i][1], 460, y, 7);
                
                if (i === 0) {
                    strokeWeight(2);
                    stroke(255, 221, 0);
                    noFill();
                    rect(105, y-2, 380, 18);
                    noStroke();
                }
                if (i === 1) {
                    strokeWeight(2);
                    stroke(133, 133, 133);
                    noFill();
                    rect(105, y-2, 380, 18);
                    noStroke();
                }
                if (i === 2) {
                    strokeWeight(2);
                    stroke(194, 129, 0);
                    noFill();
                    rect(105, y-2, 380, 18);
                    noStroke();
                }
                
                if (scores[i][0] === "YOU" && scores[i][1] === highscore) {
                    strokeWeight(2);
                    stroke(0, 0, 0);
                    noFill();
                    rect(105, y-2, 380, 18);
                    noStroke();
                }
            }
        }
    popMatrix();
    
    if (get.mouseIsPressed && mouseX() > 493 && mouseX() < 500) {
        scrolling = true;
    }
    
    if (!get.mouseIsPressed) {
        scrolling = false;
    }
    
    if (scrolling) {
        scoresScroll = mouseY()-170-(170/3.125/2);
        
        if (scoresScroll < 0) {
            scoresScroll = 0;
        }
        if (scoresScroll > 170-170/3.125) {
            scoresScroll = 170-170/3.125;
        }
    }
    
    var colors = [
        color(0, 0, 0, 1),
        color(248, 235, 227),
    ];
    
    pushMatrix();
        scale(globalScale);

        translate(-122, 70);
    
        if (mouseY() > 349+70 && mouseY() < 400+70 && mouseX() > 349-122 && mouseX() < 500-122) {
            translate(0, 5);
        }
        
        fill(79, 53, 12);
        rect(350, 350, 150, 50, 3);
        
        fill(248, 235, 227);
        rect(353, 353, 144, 42);
        
        fill(231, 97, 0);
        rect(355, 355, 140, 38);
        
        var pixelArtArray = [
            [1,0,0,0,1,0,1,1,1,0,1,0,0,1,0,1,0,0,1],
            [1,1,0,1,1,0,1,0,0,0,1,1,0,1,0,1,0,0,1],
            [1,0,1,0,1,0,1,1,1,0,1,0,1,1,0,1,0,0,1],
            [1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,1],
            [1,0,0,0,1,0,1,1,1,0,1,0,0,1,0,1,1,1,1],
        ];
        
        for (var i = 0; i < pixelArtArray[0].length; i++) {
            for (var j = 0; j < pixelArtArray.length; j++) {
                fill(colors[pixelArtArray[j][i]]);
                rect(377+i*(5), 361+j*(5), 5+1, 5+1);
            }
        }
        
        if (mouseY() > 349+70 && mouseY() < 400+70 && mouseX() > 349-122 && mouseX() < 500-122) {
            fill(0, 0, 0, 50);
            rect(350, 350, 150, 50, 3);
        }
    popMatrix();
}

function menuScene(){
    drawGround();
        
        drawPipes();
        
        drawFlappyBirdTitle();
        
    pushMatrix();
        scale(globalScale);

        var colors = [
            color(0, 0, 0, 1),
            color(248, 235, 227),
        ];
        
        noStroke();
        
        drawStartButton(colors);
        
        drawScoreButton(colors);
        
        drawSoundButton(colors);
        
        pixelText("Created by |-VEXCESS-| (2020)", 140, 479, 8);
    popMatrix();
}

function gameScene() {
    drawPipes();
    
    drawPlayer();
    
    drawGround();
    
    drawScore();
    
    if (!playing) {
        drawTap();
        speed = 0;
    }
    
    if (playing) {
        speed = 2;
        
        if (sound && score > 0 && score-floor(score) < 0.01) {
            playSound(getSound("retro/coin"));
        } else if (sound && score > 9 && score-floor(score) < 0.04) {
            playSound(getSound("retro/coin"));
        }
        
        playerY += playerYVel;
        
        playerYVel += 0.3;
        
        if (playerY < 25) {
            playerY = 25;
        }
        
        if (playerY > 415) {
            background(255, 255, 255);
            playerY = 415;
            playerYVel = 18;
            dying = true;
            scene = 3;
            if (sound) {
                playSound(getSound("rpg/hit-whack"));
            }
        }
        
        updatePipes();
        
        add_removePipes();
        
        if (dying) {
            speed = 0;
            playerYVel += 0.4;
            
            if (playerY > 415) {
                scene = 3;
            }
        }
    }
}

function deadScene() {
    if (score > highscore) {
        highscore = floor(score);
    }
    
    drawPipes();
    
    drawPlayer();
    
    drawGround();
    
    drawGameOverText();
    
    drawGameResults();
    
    if (gameResultsY < 350) {
        gameResultsY -= dist(0, 0, 0, gameResultsY)/10;
    } else {
        gameResultsY -= 1;
    }
    
    var colors = [
        color(0, 0, 0, 0),
        color(255, 255, 255),
    ];
    
    if (gameResultsY < 1 && resultsScore > score-1) {
        drawOkButton(colors);
        drawMenuButton(colors);
    }
}


frameRate(60);
dl.draw = function() {
    // loadWindowNoScroll();
    loadPixelText();
    if (loaded) {
        drawBack();
        
        if (scene === 0) {
            scoresScene();
        }
        
        if (scene === 1) {
            menuScene();
        }
        
        if (scene === 2) {
            gameScene();
        }
        
        if (scene === 3) {
            deadScene();
        }
    }
    
    if (shouldDrawLogo) {
        drawLogo();
    }
};

function flap() {
    if (!playing) {
        playing = true;
    }
    playerYVel = -5.5;
    if (sound) {
        playSound(getSound("rpg/battle-swing"));
    }
}

dl.mouseReleased = function() {
    if (scene === 0) {
        if (mouseY() > 349+70 && mouseY() < 400+70 && mouseX() > 349-122 && mouseX() < 500-122) {
            scene = 1;
        }
        
        scrolling = false;
    } else if (scene === 1) {
        if (mouseY() > 349 && mouseY() < 400) {
            if (mouseX() > 99 && mouseX() < 250) {
                scene = 2;
            }
            if (mouseX() > 349 && mouseX() < 500) {
                scene = 0;
                calculateScore = true;
            }
        }
        
        if (mouseX() > 274 && mouseX() < 325 && mouseY() > 424 && mouseY() < 475) {
            sound = !sound;
        }
    } else if (scene === 3 && gameResultsY < 1 && resultsScore > score-1) {
        if (mouseY() > 349+58 && mouseY() < 400+58 && mouseX() > 99+25 && mouseX() < 250+25) {
            resetGame();
            scene = 2;
        }
        
        if (mouseY() > 349+58 && mouseY() < 400+58 && mouseX() > 349-25 && mouseX() < 500-25) {
            resetGame();
            scene = 1;
        }
    }
};

dl.mousePressed = function() {
    if (scene === 2 && !dying) {
        flap();
    }
};

dl.keyPressed = function() {
    if (scene === 2 && !dying) {
        flap();
    }
};

window.addEventListener("wheel", (e) => {
    var mouseScroll = 0;

    if (e.wheelDelta) {
        mouseScroll = e.wheelDelta / 120;
        if (window.opera) {
            mouseScroll = -mouseScroll;
        }
    } else if (e.detail) {
        mouseScroll = -e.detail / 3;
    }

    if (scene === 0 && mouseX() > 100 && mouseX() < 500 && mouseY() > 180 && mouseY() < 180+170) {
        scoresScroll -= mouseScroll*5;
        if (scoresScroll < 0) {
            scoresScroll = 0;
        }
        if (scoresScroll > 170-170/3.125) {
            scoresScroll = 170-170/3.125;
        }
    }
});

    </script>


</body>
</html>